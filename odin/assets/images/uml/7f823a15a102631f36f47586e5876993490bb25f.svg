<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="849px" preserveAspectRatio="none" style="width:2087px;height:849px;" version="1.1" viewBox="0 0 2087 849" width="2087px" zoomAndPan="magnify"><defs><filter height="300%" id="f15ggn2t316p7z" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f15ggn2t316p7z)" height="292.7949" style="stroke: #000000; stroke-width: 2.0;" width="2062.5" x="13" y="451.9043"/><rect fill="#FFFFFF" height="60.6211" style="stroke: none; stroke-width: 1.0;" width="2062.5" x="13" y="684.0781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="72" x2="72" y1="86.4883" y2="761.6992"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="577" x2="577" y1="86.4883" y2="761.6992"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1046.5" x2="1046.5" y1="86.4883" y2="761.6992"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1184.5" x2="1184.5" y1="86.4883" y2="761.6992"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1329.5" x2="1329.5" y1="86.4883" y2="761.6992"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1635" x2="1635" y1="86.4883" y2="761.6992"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2013.5" x2="2013.5" y1="86.4883" y2="761.6992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="23" y="83.5352">User/Browser</text><ellipse cx="72.5" cy="13" fill="#FEFECE" filter="url(#f15ggn2t316p7z)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M72.5,21 L72.5,48 M59.5,29 L85.5,29 M72.5,48 L59.5,63 M72.5,48 L85.5,63 " fill="none" filter="url(#f15ggn2t316p7z)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="23" y="774.2344">User/Browser</text><ellipse cx="72.5" cy="787.1875" fill="#FEFECE" filter="url(#f15ggn2t316p7z)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M72.5,795.1875 L72.5,822.1875 M59.5,803.1875 L85.5,803.1875 M72.5,822.1875 L59.5,837.1875 M72.5,822.1875 L85.5,837.1875 " fill="none" filter="url(#f15ggn2t316p7z)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f15ggn2t316p7z)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="47" x="552" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="559" y="71.5352">Odin</text><rect fill="#FEFECE" filter="url(#f15ggn2t316p7z)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="47" x="552" y="760.6992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="559" y="781.2344">Odin</text><rect fill="#FEFECE" filter="url(#f15ggn2t316p7z)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="981.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="988.5" y="71.5352">OpenID Provider</text><rect fill="#FEFECE" filter="url(#f15ggn2t316p7z)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="981.5" y="760.6992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="988.5" y="781.2344">OpenID Provider</text><rect fill="#FEFECE" filter="url(#f15ggn2t316p7z)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="1121.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="1128.5" y="71.5352">Token endpoint</text><rect fill="#FEFECE" filter="url(#f15ggn2t316p7z)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="1121.5" y="760.6992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="1128.5" y="781.2344">Token endpoint</text><rect fill="#FEFECE" filter="url(#f15ggn2t316p7z)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="1258.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="1265.5" y="71.5352">UserInfo endpoint</text><rect fill="#FEFECE" filter="url(#f15ggn2t316p7z)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="1258.5" y="760.6992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="1265.5" y="781.2344">UserInfo endpoint</text><rect fill="#FEFECE" filter="url(#f15ggn2t316p7z)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="1544" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="1551" y="71.5352">User Registration Server</text><rect fill="#FEFECE" filter="url(#f15ggn2t316p7z)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="1544" y="760.6992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="1551" y="781.2344">User Registration Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="1961.5" y="83.5352">User Identities</text><path d="M1995.5,34 C1995.5,24 2013.5,24 2013.5,24 C2013.5,24 2031.5,24 2031.5,34 L2031.5,60 C2031.5,70 2013.5,70 2013.5,70 C2013.5,70 1995.5,70 1995.5,60 L1995.5,34 " fill="#FEFECE" filter="url(#f15ggn2t316p7z)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1995.5,34 C1995.5,44 2013.5,44 2013.5,44 C2013.5,44 2031.5,44 2031.5,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="1961.5" y="774.2344">User Identities</text><path d="M1995.5,787.1875 C1995.5,777.1875 2013.5,777.1875 2013.5,777.1875 C2013.5,777.1875 2031.5,777.1875 2031.5,787.1875 L2031.5,813.1875 C2031.5,823.1875 2013.5,823.1875 2013.5,823.1875 C2013.5,823.1875 1995.5,823.1875 1995.5,813.1875 L1995.5,787.1875 " fill="#FEFECE" filter="url(#f15ggn2t316p7z)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1995.5,787.1875 C1995.5,797.1875 2013.5,797.1875 2013.5,797.1875 C2013.5,797.1875 2031.5,797.1875 2031.5,787.1875 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><polygon fill="#A80036" points="565.5,113.7988,575.5,117.7988,565.5,121.7988,569.5,117.7988" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="571.5" y1="117.7988" y2="117.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="79.5" y="113.0566">Selects new account registration</text><polygon fill="#A80036" points="83.5,143.1094,73.5,147.1094,83.5,151.1094,79.5,147.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="77.5" x2="576.5" y1="147.1094" y2="147.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="481" x="89.5" y="142.3672">Generates OpenID Connect Authorize request and redirects to OpenID server</text><polygon fill="#A80036" points="1034.5,172.4199,1044.5,176.4199,1034.5,180.4199,1038.5,176.4199" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="1040.5" y1="176.4199" y2="176.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="79.5" y="171.6777">Authenticates</text><polygon fill="#A80036" points="83.5,201.7305,73.5,205.7305,83.5,209.7305,79.5,205.7305" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="77.5" x2="1045.5" y1="205.7305" y2="205.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="302" x="89.5" y="200.9883">Redirects user back to Odin with one-time code</text><polygon fill="#A80036" points="565.5,231.041,575.5,235.041,565.5,239.041,569.5,235.041" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="571.5" y1="235.041" y2="235.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="79.5" y="230.2988">Request authorization with one-time code</text><polygon fill="#A80036" points="588.5,260.3516,578.5,264.3516,588.5,268.3516,584.5,264.3516" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1173,260.3516,1183,264.3516,1173,268.3516,1177,264.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="582.5" x2="1179" y1="264.3516" y2="264.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="269" x="594.5" y="259.6094">Exchange one-time code for access-token</text><polygon fill="#A80036" points="588.5,289.6621,578.5,293.6621,588.5,297.6621,584.5,293.6621" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1317.5,289.6621,1327.5,293.6621,1317.5,297.6621,1321.5,293.6621" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="582.5" x2="1323.5" y1="293.6621" y2="293.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="270" x="594.5" y="288.9199">Use access-token to obtain user-identifier</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="577.5" x2="619.5" y1="322.9727" y2="322.9727"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="619.5" x2="619.5" y1="322.9727" y2="335.9727"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="578.5" x2="619.5" y1="335.9727" y2="335.9727"/><polygon fill="#A80036" points="588.5,331.9727,578.5,335.9727,588.5,339.9727,584.5,335.9727" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="455" x="584.5" y="318.2305">Generate 'CA' user certificate with hash of user-identifier + random-key</text><polygon fill="#A80036" points="1623.5,361.2832,1633.5,365.2832,1623.5,369.2832,1627.5,365.2832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="577.5" x2="1629.5" y1="365.2832" y2="365.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="394" x="584.5" y="360.541">Pass access-token, certificate, user-identifer and random-key</text><polygon fill="#A80036" points="1340.5,390.5938,1330.5,394.5938,1340.5,398.5938,1336.5,394.5938" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1623.5,390.5938,1633.5,394.5938,1623.5,398.5938,1627.5,394.5938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1334.5" x2="1629.5" y1="394.5938" y2="394.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="282" x="1346.5" y="389.8516">Retrieve user-identifier belonging to session</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1635.5" x2="1677.5" y1="423.9043" y2="423.9043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1677.5" x2="1677.5" y1="423.9043" y2="436.9043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1636.5" x2="1677.5" y1="436.9043" y2="436.9043"/><polygon fill="#A80036" points="1646.5,432.9043,1636.5,436.9043,1646.5,440.9043,1642.5,436.9043" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="226" x="1642.5" y="419.1621">Verify user-identifier and certificate</text><path d="M13,451.9043 L75,451.9043 L75,458.9043 L65,468.9043 L13,468.9043 L13,451.9043 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="292.7949" style="stroke: #000000; stroke-width: 2.0;" width="2062.5" x="13" y="451.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="28" y="465.4727">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="90" y="464.5391">[authorisation request legitimate]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1635.5" x2="1677.5" y1="490.5254" y2="490.5254"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1677.5" x2="1677.5" y1="490.5254" y2="503.5254"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1636.5" x2="1677.5" y1="503.5254" y2="503.5254"/><polygon fill="#A80036" points="1646.5,499.5254,1636.5,503.5254,1646.5,507.5254,1642.5,503.5254" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="1642.5" y="485.7832">Sign certificate</text><polygon fill="#A80036" points="1646.5,528.8359,1636.5,532.8359,1646.5,536.8359,1642.5,532.8359" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="2001.5,528.8359,2011.5,532.8359,2001.5,536.8359,2005.5,532.8359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1640.5" x2="2007.5" y1="532.8359" y2="532.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="354" x="1652.5" y="528.0938">Store user-identifier, signed certificate and random-key</text><polygon fill="#A80036" points="588.5,558.1465,578.5,562.1465,588.5,566.1465,584.5,562.1465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="582.5" x2="1634.5" y1="562.1465" y2="562.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="594.5" y="557.4043">Pass signed-certificate</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="577.5" x2="619.5" y1="591.457" y2="591.457"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="619.5" x2="619.5" y1="591.457" y2="604.457"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="578.5" x2="619.5" y1="604.457" y2="604.457"/><polygon fill="#A80036" points="588.5,600.457,578.5,604.457,588.5,608.457,584.5,604.457" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="399" x="584.5" y="586.7148">store signed-certicate and register as login-entrypoint for user</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="577.5" x2="619.5" y1="633.7676" y2="633.7676"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="619.5" x2="619.5" y1="633.7676" y2="646.7676"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="578.5" x2="619.5" y1="646.7676" y2="646.7676"/><polygon fill="#A80036" points="588.5,642.7676,578.5,646.7676,588.5,650.7676,584.5,646.7676" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="355" x="584.5" y="629.0254">[Perform (machine) session creation flow in background]</text><polygon fill="#A80036" points="83.5,672.0781,73.5,676.0781,83.5,680.0781,79.5,676.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="77.5" x2="576.5" y1="676.0781" y2="676.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="89.5" y="671.3359">Show sign-up successful</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="2075.5" y1="685.0781" y2="685.0781"/><polygon fill="#A80036" points="588.5,703.3887,578.5,707.3887,588.5,711.3887,584.5,707.3887" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="582.5" x2="1634.5" y1="707.3887" y2="707.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="594.5" y="702.6465">User registration request denied</text><polygon fill="#A80036" points="83.5,732.6992,73.5,736.6992,83.5,740.6992,79.5,736.6992" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="77.5" x2="576.5" y1="736.6992" y2="736.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="89.5" y="731.957">User registration request denied</text><!--
@startuml

actor "User/Browser" as user
participant Odin as odin
participant "OpenID Provider" as openId
participant "Token endpoint" as getToken
participant "UserInfo endpoint" as userInfo
participant "User Registration Server" as userRegistry
database "User Identities" as usersDb

user -> odin : Selects new account registration
user <- odin : Generates OpenID Connect Authorize request and redirects to OpenID server
user -> openId : Authenticates
user <- openId : Redirects user back to Odin with one-time code
user -> odin : Request authorization with one-time code

odin <-> getToken : Exchange one-time code for access-token
odin <-> userInfo : Use access-token to obtain user-identifier
odin -> odin : Generate 'CA' user certificate with hash of user-identifier + random-key
odin -> userRegistry : Pass access-token, certificate, user-identifer and random-key

userRegistry <-> userInfo : Retrieve user-identifier belonging to session
userRegistry -> userRegistry : Verify user-identifier and certificate

alt authorisation request legitimate
    userRegistry -> userRegistry : Sign certificate
    userRegistry <-> usersDb : Store user-identifier, signed certificate and random-key
    odin <- userRegistry : Pass signed-certificate
    odin -> odin : store signed-certicate and register as login-entrypoint for user
    odin -> odin : [Perform (machine) session creation flow in background]
    user <- odin : Show sign-up successful
else
    odin <- userRegistry : User registration request denied
    user <- odin : User registration request denied
end

@enduml

PlantUML version 1.2018.14(Fri Dec 21 17:33:16 CET 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 9.0.4+11
Operating System: Mac OS X
OS Version: 10.14.5
Default Encoding: UTF-8
Language: en
Country: NL
--></g></svg>